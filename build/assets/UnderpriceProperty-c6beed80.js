import{am as L,r as c,ao as M,j as s}from"./index-c61e8b64.js";import{B as q}from"./Button-fb2240eb.js";import{I as $}from"./Input-02b0842b.js";import{D as E}from"./DataTable-d852dcc0.js";import{S as O}from"./SearchIcon-598e1613.js";import{e as R,D as G}from"./exportExcel-576478c7.js";import"./context-ce67dbba.js";import"./Views-4c7db57f.js";import"./isNil-4bf62b3e.js";import"./get-6536235b.js";import"./toString-66698047.js";import"./Select-caf7af29.js";import"./slicedToArray-519bc2fc.js";import"./objectWithoutProperties-82d8236c.js";import"./_getPrototype-d4ebae27.js";const le=()=>{const C=L(),[h,B]=c.useState(""),[T,S]=c.useState([]),[D,b]=c.useState(!1),[y,k]=c.useState(1),[w,I]=c.useState(10),[F,j]=c.useState(0),[i,U]=c.useState({key:"",order:""}),N=(e,t)=>{var p,v,f,_,z,A;const r=((v=(p=e==null?void 0:e.id)==null?void 0:p.toString)==null?void 0:v.call(p))||((_=(f=e==null?void 0:e._id)==null?void 0:f.toString)==null?void 0:_.call(f))||`${t}`,a=(e==null?void 0:e.address)||(e==null?void 0:e.full_address)||[e==null?void 0:e.street,e==null?void 0:e.city,e==null?void 0:e.state].filter(Boolean).join(", ")||"-",o=((e==null?void 0:e.bed)??(e==null?void 0:e.beds)??(e==null?void 0:e.bedrooms)??"-")+"",l=((e==null?void 0:e.bath)??(e==null?void 0:e.baths)??(e==null?void 0:e.bathrooms)??"-")+"",u=(e==null?void 0:e.city)||((z=e==null?void 0:e.location)==null?void 0:z.city)||"-",n=(e==null?void 0:e.state)||((A=e==null?void 0:e.location)==null?void 0:A.state)||"-",d=(e==null?void 0:e.price)||(e==null?void 0:e.price_text)||(e==null?void 0:e.amount),g=typeof d=="number"?`$${d.toLocaleString()}`:d||"-",x=(e==null?void 0:e.chatgptPriceAnalysis)||(e==null?void 0:e.analysis)||(e==null?void 0:e.gpt_analysis)||"-";return{id:r,address:a,bed:o,bath:l,city:u,state:n,price:g,chatgptPriceAnalysis:x}},P=c.useCallback(async()=>{b(!0);try{const e=y<=1?0:y,t={limit:w,offset:e,page:y,search:h??"",is_displayed:!0,sort:i.key||void 0,sort_order:i.order?i.order.toUpperCase():void 0},a=(await M.fetchData({url:"/admin/properties/under-priced/list",method:"post",data:t})).data;let o=[],l=0;if(Array.isArray(a))o=a,l=a.length;else if(a!=null&&a.data){const n=a.data;o=n.rows||n.list||n.items||n.data||[],l=n.total??a.total??o.length}else o=(a==null?void 0:a.rows)||(a==null?void 0:a.list)||(a==null?void 0:a.items)||[],l=(a==null?void 0:a.total)??o.length;const u=o.map((n,d)=>N(n,d));S(u),j(typeof l=="number"?l:u.length)}catch{S([]),j(0)}finally{b(!1)}},[y,w,h,i]);c.useEffect(()=>{const e=setTimeout(()=>{P()},300);return()=>clearTimeout(e)},[P]);const K=[{header:"Address",accessorKey:"address",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("div",{className:"flex items-center",children:s.jsx("span",{className:"",children:t.address})})}},{header:"Bed",accessorKey:"bed",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("span",{className:"",children:t.bed})}},{header:"Bath",accessorKey:"bath",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("span",{className:"",children:t.bath})}},{header:"City",accessorKey:"city",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("span",{className:"",children:t.city})}},{header:"State",accessorKey:"state",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("span",{className:"",children:t.state})}},{header:"Price",accessorKey:"price",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("span",{className:"",children:t.price})}},{header:"ChatGPT Price Analysis",accessorKey:"chatgptPriceAnalysis",enableSorting:!0,cell:e=>{const t=e.row.original;return s.jsx("div",{className:"max-w-xs",children:s.jsx("span",{className:"text-sm text-gray-600 line-clamp-2",children:t.chatgptPriceAnalysis})})}}];return s.jsxs("div",{className:"min-h-screen w-full",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 mb-6",children:[s.jsx("h1",{className:"text-[#202224] font-nunito text-[24px] font-bold leading-none tracking-[-0.114px]",children:"Underprice Property"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto sm:items-center",children:[s.jsxs("div",{className:"relative bg-white rounded-[35px] w-full sm:w-auto",children:[s.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),s.jsx($,{type:"text",placeholder:"Search Users",value:h,onChange:e=>B(e.target.value),className:"pl-10 w-full sm:w-[253px] text-[#202224] font-normal text-[14px] leading-none font-nunito rounded-[19px] border border-[#D5D5D5] bg-white"})]}),s.jsxs("div",{className:"flex flex-row gap-2 w-full sm:w-auto justify-end",children:[s.jsx(q,{variant:"solid",size:"sm",className:"flex items-center justify-center text-white text-center font-nunito text-[12px] font-bold px-[16px] py-[11px] !rounded-[19px] !bg-[#4880FF] w-full sm:w-auto",onClick:()=>C("/underprice-property/manage"),children:"Manage"}),s.jsxs(q,{variant:"solid",size:"sm",className:"flex items-center justify-center text-white text-center font-nunito text-[12px] font-bold px-[16px] py-[11px] !rounded-[19px] !bg-[#4880FF] w-full sm:w-auto",onClick:async()=>{await R({endpoint:"/admin/properties/under-priced/list",filename:"underpriced-properties.csv",basePayload:{search:h??"",is_displayed:!0,sort:i.key||void 0,sort_order:i.order?i.order.toUpperCase():void 0},limitPerPage:200,normalize:(e,t)=>{var n,d,g,x,p;const r=N(e,t),a=typeof(e==null?void 0:e.price)=="number"?e.price:typeof(e==null?void 0:e.amount)=="number"?e.amount:void 0,o=(e==null?void 0:e.sqft)??(e==null?void 0:e.square_feet)??(e==null?void 0:e.squareFeet)??(e==null?void 0:e.area)??(e==null?void 0:e.livingArea)??(e==null?void 0:e.size),l=typeof o=="number"?o:o!=null&&!isNaN(Number(o))?Number(o):void 0,u=a&&l?`$${(a/l).toFixed(2)}`:"-";return{...r,zip:(e==null?void 0:e.zip)??(e==null?void 0:e.zip_code)??(e==null?void 0:e.zipcode)??(e==null?void 0:e.postal_code)??"-",sqft:(e==null?void 0:e.sqft)??(e==null?void 0:e.square_feet)??(e==null?void 0:e.squareFeet)??(e==null?void 0:e.area)??(e==null?void 0:e.livingArea)??(e==null?void 0:e.size)??"-",lotSize:(e==null?void 0:e.lot_size)??(e==null?void 0:e.lotSize)??(e==null?void 0:e.lot_sqft)??(e==null?void 0:e.lotAcres)??(e==null?void 0:e.lot_acres)??"-",yearBuilt:(e==null?void 0:e.year_built)??(e==null?void 0:e.yearBuilt)??(e==null?void 0:e.built_year)??"-",propertyType:(e==null?void 0:e.property_type)??(e==null?void 0:e.propertyType)??(e==null?void 0:e.type)??"-",pricePerSqft:u,mlsId:(e==null?void 0:e.mls_id)??(e==null?void 0:e.mlsId)??(e==null?void 0:e.mls)??"-",county:(e==null?void 0:e.county)??((n=e==null?void 0:e.location)==null?void 0:n.county)??"-",latitude:(e==null?void 0:e.lat)??(e==null?void 0:e.latitude)??((d=e==null?void 0:e.location)==null?void 0:d.lat)??((g=e==null?void 0:e.location)==null?void 0:g.latitude)??"-",longitude:(e==null?void 0:e.lng)??(e==null?void 0:e.longitude)??((x=e==null?void 0:e.location)==null?void 0:x.lng)??((p=e==null?void 0:e.location)==null?void 0:p.longitude)??"-",daysOnMarket:(e==null?void 0:e.dom)??(e==null?void 0:e.days_on_market)??(e==null?void 0:e.daysOnMarket)??"-",status:(e==null?void 0:e.status)??(e==null?void 0:e.listing_status)??(e==null?void 0:e.sale_status)??"-",url:(e==null?void 0:e.url)??(e==null?void 0:e.link)??(e==null?void 0:e.listing_url)??"-"}},columns:[{header:"Address",key:"address"},{header:"Bed",key:"bed"},{header:"Bath",key:"bath"},{header:"City",key:"city"},{header:"State",key:"state"},{header:"Price",key:"price"},{header:"ChatGPT Price Analysis",key:"chatgptPriceAnalysis"},{header:"Zip",key:"zip"},{header:"SqFt",key:"sqft"},{header:"Lot Size",key:"lotSize"},{header:"Year Built",key:"yearBuilt"},{header:"Property Type",key:"propertyType"},{header:"Price / SqFt",key:"pricePerSqft"},{header:"MLS ID",key:"mlsId"},{header:"County",key:"county"},{header:"Latitude",key:"latitude"},{header:"Longitude",key:"longitude"},{header:"Days on Market",key:"daysOnMarket"},{header:"Status",key:"status"},{header:"URL",key:"url"}]})},children:["Download",s.jsx(G,{className:"ml-2",size:16})]})]})]})]}),s.jsx("div",{className:"",children:s.jsx(E,{columns:K,data:T,loading:D,onPaginationChange:e=>k(e),onSelectChange:e=>{I(e),k(1)},onSort:e=>U(e),pageSizes:[10,25,50],pagingData:{total:F,pageIndex:y,pageSize:w}})})]})};export{le as default};
